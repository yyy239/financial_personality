
import numpy as np
from keras.models import load_model

questions = [
    "1. 你是否经常计划长期的财务目标？\n    1=从不  5=总是",
    "2. 面对市场波动你会保持冷静吗？\n    1=非常紧张  5=非常冷静",
    "3. 你更愿意将钱存银行而非投资？\n    1=完全不同意  5=完全同意",
    "4. 资产短期下跌20%你会继续持有吗？\n    1=立即卖出  5=坚定持有",
    "5. 你喜欢尝试新的投资机会吗？\n    1=完全不喜欢  5=非常喜欢",
    "6. 你相信自己能选出好股票吗？\n    1=完全没有信心  5=非常有信心",
    "7. 你会因朋友建议改变投资决策吗？\n    1=从不  5=总是",
    "8. 你是否倾向将收入存起来？\n    1=完全不存  5=大量存",
    "9. 你更关注长期回报还是短期收益？\n    1=短期为主  5=长期为主",
    "10. 你是否愿意承担高风险换高回报？\n    1=完全不愿意  5=非常愿意",
    "11. 你是否有设定财务预算的习惯？\n    1=从不  5=总是",
    "12. 你是否会关注财经新闻来指导投资？\n    1=从不  5=非常频繁",
    "13. 你是否会分散投资而不是集中投资？\n    1=完全不分散  5=高度分散",
    "14. 你如何看待亏损后的再投资？\n    1=立即退出  5=坚持再投",
    "15. 你是否愿意投资于你不了解的领域？\n    1=完全不愿意  5=非常愿意",
    "16. 你是否曾有明确的资产配置策略？\n    1=从未有过  5=非常清晰",
    "17. 你是否有固定的投资周期？\n    1=没有计划  5=非常规律",
    "18. 你是否会在市场恐慌时加仓？\n    1=完全不会  5=积极加仓",
    "19. 你更信赖数据还是直觉进行投资？\n    1=完全靠直觉  5=完全靠数据",
    "20. 你会定期评估和调整投资组合吗？\n    1=从不评估  5=定期调整"
]

model = load_model("models/personality_model.h5")
answers = []
print("请回答以下问题，每题输入1~5之间的整数：\n")
for q in questions:
    print(q)
    while True:
        try:
            val = int(input("你的选择 (1-5): "))
            if 1 <= val <= 5:
                answers.append(val)
                break
            else:
                print("请输入1-5之间的整数")
        except:
            print("输入无效，请重新输入。")

x = np.array(answers).reshape(1, -1)
score = model.predict(x)[0][0] * 100
score = np.clip(score, 0, 100)

if score < 25:
    persona = "保守型"
elif score < 50:
    persona = "稳健型"
elif score < 75:
    persona = "进取型"
else:
    persona = "激进型"

print(f"\n预测得分：{score:.2f}")
print(f"投资人格类型：{persona}")
